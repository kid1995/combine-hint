{
  "name": "Hint-Migration-Test",
  "version": "1",
  "items": [
    {
      "type": "http",
      "name": "Count Migration",
      "filename": "Count Migration.bru",
      "seq": 9,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/count?dataSetStartDate=2025-04-01T00:00:00&dataSetEndDate=2026-10-01T00:00:00",
        "method": "POST",
        "headers": [],
        "params": [
          {
            "name": "dataSetStartDate",
            "value": "2025-04-01T00:00:00",
            "type": "query",
            "enabled": true
          },
          {
            "name": "dataSetEndDate",
            "value": "2026-10-01T00:00:00",
            "type": "query",
            "enabled": true
          }
        ],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Login",
      "filename": "Login.bru",
      "seq": 7,
      "settings": {
        "encodeUrl": true
      },
      "tags": [],
      "request": {
        "url": "{{auth_url}}/auth/token/ccgjwt/60",
        "method": "POST",
        "headers": [],
        "params": [],
        "body": {
          "mode": "formUrlEncoded",
          "formUrlEncoded": [
            {
              "name": "grant_type",
              "value": "client_credentials",
              "enabled": true
            }
          ],
          "multipartForm": [],
          "file": []
        },
        "script": {
          "res": "const data = res.getBody();\nif (res.getStatus() === 200 && data.access_token) {\n  bru.setVar(\"authToken\", data.access_token);\n}"
        },
        "vars": {},
        "assertions": [],
        "tests": "test(\"Login successful and token stored\", function() {\n  const data = res.getBody();\n  expect(res.getStatus()).to.equal(200);\n  expect(data.access_token).to.exist;\n});",
        "docs": "",
        "auth": {
          "mode": "basic",
          "basic": {
            "username": "{{username}}",
            "password": "{{password}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Validate Migration",
      "filename": "Validate Migration.bru",
      "seq": 10,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/start?dataSetStartDate=2025-01-01T00:00:00&dataSetEndDate=2026-10-01T00:00:00",
        "method": "POST",
        "headers": [],
        "params": [
          {
            "name": "dataSetStartDate",
            "value": "2025-01-01T00:00:00",
            "type": "query",
            "enabled": true
          },
          {
            "name": "dataSetEndDate",
            "value": "2026-10-01T00:00:00",
            "type": "query",
            "enabled": true
          }
        ],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {
          "res": "const now = new Date();\nconst hours = now.getHours(); \nconst minutes = now.getMinutes(); \nconst seconds = now.getSeconds(); \n\nconst data = res.getBody();\nif (res.getStatus() === 200) {\n  console.log(JSON.stringify(res.body))\n  bru.setVar(\"job-id-\"+\"${hours}:${minutes}:${seconds}\", JSON.stringify(res.body));\n}"
        },
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Fix Errors for a Job",
      "filename": "fix-errors.bru",
      "seq": 7,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/fix/1",
        "method": "POST",
        "headers": [],
        "params": [],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Get Error by ID",
      "filename": "get-error-by-id.bru",
      "seq": 6,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/errors/1",
        "method": "GET",
        "headers": [],
        "params": [],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Get All Errors",
      "filename": "get-errors.bru",
      "seq": 5,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/errors",
        "method": "GET",
        "headers": [],
        "params": [],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Get Job by ID",
      "filename": "get-job-by-id.bru",
      "seq": 4,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/jobs/:job_id",
        "method": "GET",
        "headers": [],
        "params": [
          {
            "name": "job_id",
            "value": "3",
            "type": "path",
            "enabled": true
          }
        ],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Get All Jobs",
      "filename": "get-jobs.bru",
      "seq": 3,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/jobs",
        "method": "GET",
        "headers": [],
        "params": [],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {},
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    },
    {
      "type": "http",
      "name": "Start Migration",
      "filename": "start-migration.bru",
      "seq": 2,
      "settings": {},
      "tags": [],
      "request": {
        "url": "{{hint_api}}/api/migration/start?dataSetStartDate=2025-01-01T00:00:00&dataSetEndDate=2026-10-01T00:00:00",
        "method": "POST",
        "headers": [],
        "params": [
          {
            "name": "dataSetStartDate",
            "value": "2025-01-01T00:00:00",
            "type": "query",
            "enabled": true
          },
          {
            "name": "dataSetEndDate",
            "value": "2026-10-01T00:00:00",
            "type": "query",
            "enabled": true
          }
        ],
        "body": {
          "mode": "none",
          "formUrlEncoded": [],
          "multipartForm": [],
          "file": []
        },
        "script": {
          "res": "const now = new Date();\nconst hours = now.getHours(); \nconst minutes = now.getMinutes(); \nconst seconds = now.getSeconds(); \n\nconst data = res.getBody();\nif (res.getStatus() === 200) {\n  console.log(JSON.stringify(res.body))\n  bru.setVar(\"job-id-\"+\"${hours}:${minutes}:${seconds}\", JSON.stringify(res.body));\n}"
        },
        "vars": {},
        "assertions": [],
        "tests": "",
        "docs": "",
        "auth": {
          "mode": "bearer",
          "bearer": {
            "token": "{{authToken}}"
          }
        }
      }
    }
  ],
  "activeEnvironmentUid": "hWCL2DkE6YpnyC2GkdYfT",
  "environments": [
    {
      "variables": [
        {
          "name": "username",
          "value": "U167653",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "auth_url",
          "value": "https://employee.login.abn.signal-iduna.org",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "hint_api",
          "value": "https://abn-hint-elpa-hint-abn.cloud-test.system.local",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "authToken",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        },
        {
          "name": "password",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        }
      ],
      "name": "ABN"
    },
    {
      "variables": [
        {
          "name": "username",
          "value": "U167653",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "auth_url",
          "value": "https://employee.login.int.signal-iduna.org",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "hint_api",
          "value": "http://localhost:8080",
          "enabled": true,
          "secret": false,
          "type": "text"
        },
        {
          "name": "authToken",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        },
        {
          "name": "password",
          "value": "",
          "enabled": true,
          "secret": true,
          "type": "text"
        }
      ],
      "name": "TST"
    }
  ],
  "brunoConfig": {
    "version": "1",
    "name": "Hint-Migration-Test",
    "type": "collection",
    "ignore": [
      "node_modules",
      ".git"
    ],
    "size": 0.0034637451171875,
    "filesCount": 12
  }
}