apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

nameSuffix: -tst-service

resources:
- ../../base
- admin-virtualservice.yaml
- destination-rule.yaml

components:
- ../../base/components/postgres
- ../components/postgres
- ../../base/components/kafka
- ../components/kafka
- ../../base/components/mongo
- ../components/mongo

images:
- name: app-image
  newName: newimag/pro
  newTag: asd.s

configMapGenerator:
- behavior: merge
  literals:
  - SERVICE_NAME=tst-service
  - POSTGRES_SCHEMA_NAME=tst-schema
  - AUTH_URL=das.com
  name: backend-cm

patches:
- path: virtualservice-patch.yaml
- path: service-app-patch.yaml
- path: deployment-patch.yaml
